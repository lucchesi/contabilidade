<!doctype html>
 
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Contabilidade</title>
	
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css" />
	
    <script>
    $(function() {
        $( "#tabs" ).tabs();
    });
	
	
	function processa() {
		//## Parsear os dados ##//
		bla = document.getElementById("dados").value;
		lines = bla.split("\n");
		ativo = false;
		circ = false;
		ble = "";
		periodos = new Array();
		
		function _periodo()
		{
			this.nome = "X1";
			this.at_circ = new Array();
			this.at_n_circ = new Array();
			this.pa_circ = new Array();
			this.pa_n_circ = new Array();
		}
		
		periodo = null;
		periodo = new _periodo();
		for(i in lines)
		{
			asd = /Periodo/.exec(lines[i]);
			if(asd)
			{
				asd = lines[i].split(" = ");
				periodo.nome = asd[1];
				continue;
			}
			
			asd = /Ativo circulante/.exec(lines[i]);
			if(asd)
			{
				ativo = true;
				circ = true;
				continue;
			}
			asd = /Passivo circulante/.exec(lines[i]);
			if(asd)
			{
				ativo = false;
				circ = true;
				continue;
			}
			asd = /Ativo não circulante/.exec(lines[i]);
			if(asd)
			{
				ativo = true;
				circ = false;
				continue;
			}
			asd = /Passivo não circulante/.exec(lines[i]);
			if(asd)
			{
				ativo = false;
				circ = false;
				continue;
			}
			
			if(lines[i])
			{
				asd = lines[i].split(" = ");
				if(ativo)
				{
					if(circ)
					{
						periodo.at_circ[ asd[0] ] = asd[1];
					}
					else
					{
						periodo.at_n_circ[ asd[0] ] = asd[1];
					}
				}
				else
				{
					if(circ)
					{
						periodo.pa_circ[ asd[0] ] = asd[1];
					}
					else
					{
						periodo.pa_n_circ[ asd[0] ] = asd[1];
					}
				}
			}
		}
		
		k1 = 0;
		tmp = "<b>Ativo circulante:</b><br />";
		for (i in periodo.at_circ){
			tmp += i + ": " + periodo.at_circ[i] + "</b><br />";
			k1 += parseFloat(periodo.at_circ[i]);
		}
		tmp += "<i>total: " + k1 + "</i><br />";
		periodo.AC = k1;
		
		tmp += "<br />";
		
		k2=0;
		tmp += "<b>Ativo não circulante:</b><br />";
		for (i in periodo.at_n_circ){
			tmp += i + ": " + periodo.at_n_circ[i] + "</b><br />";
			k2 += parseFloat(periodo.at_n_circ[i]);
		}
		tmp += "<i>total: " + k2 + "</i><br />";
		periodo.ANC = k2;
		
		tmp += "<br />";
		tmp += "<b><i>total ativo: " + (k1+k2) + "</i></b><br />";
		periodo.A = k1 + k2;
		document.getElementById("bp_ativo").innerHTML = tmp;
		
		k1 = 0;
		tmp = "<b>Passivo circulante:</b><br />";
		for (i in periodo.pa_circ){
			tmp += i + ": " + periodo.pa_circ[i] + "</b><br />";
			k1 += parseFloat(periodo.pa_circ[i]);
		}
		tmp += "<i>total: " + k1 + "</i><br />";
		periodo.PC = k1;
		
		tmp += "<br />";
		
		k2 = 0;
		tmp += "<b>Passivo não circulante:</b><br />";
		for (i in periodo.pa_n_circ){
			if (isNaN(parseFloat(periodo.pa_n_circ[i]))) continue;
			tmp += i + ": " + periodo.pa_n_circ[i] + "</b><br />";
			k2 += parseFloat(periodo.pa_n_circ[i]);
		}
		tmp += "<i>total: " + k2 + "</i><br />";
		periodo.PNC = k2;
		
		tmp += "<br />";
		tmp += "<b><i>total passivo: " + (k1+k2) + "</i></b><br />";
		periodo.P = k1 + k2;
		document.getElementById("bp_passivo").innerHTML = tmp;
		/*
		asd = /#/.exec(lines[i]);
		console.log(asd, lines[i])
		if(!asd)
			ble += lines[i] + "<br \\>";
		*/
		tmp = "\\\[\\it\\text{Liquidez Imediata} = \\frac{\\it\\text{Disponível}}{\\it\\text{Passivo circulante}} = \\\]";
		tmp = "\\\[\\it\\text{Liquidez Corrente} = \\frac{\\it\\text{Ativo circulante}}{\\it\\text{Passivo circulante}} = \\frac{" + periodo.AC + "}{" + periodo.PC + "} = " + (periodo.AC / periodo.PC).toPrecision(2) + "\\\]";
		document.getElementById("tabs-8").innerHTML = ble;
		
		document.getElementById("tabs-3").innerHTML = tmp;
		
		MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
	}
    </script>
</head>
<body onload="javascript:processa()">
 
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Entrada de dados</a></li>
        <li><a href="#tabs-2">Balanço Patrimonial (BP)</a></li>
        <li><a href="#tabs-3">Indicadores – Liquidez</a></li>
        <li><a href="#tabs-4">Demonstração de Resultado do Exercício (DRE)</a></li>
        <li><a href="#tabs-5">Indicadores – Situação econômica</a></li>
        <li><a href="#tabs-6">Demonstração dos fluxos de caixa (DFC)</a></li>
        <li><a href="#tabs-7">Demonstração dos Lucros e Prejuízos Acumulados (DLPAc)</a></li>
        <li><a href="#tabs-8">Demonstração da mutação do PL (DMPL)</a></li>
    </ul>
	
	
	
    <div id="tabs-1">
		<textarea id="dados" rows="12" cols="60"  onkeydown="javascript:processa();" onkeyup="javascript:processa();">
## Período = X1
# Ativo circulante:
Caixa = 120
Ações = 20
Estoques = 260

# Ativo não circulante:
Máquinas  e equipamentos = 70
Móveis = 10
Instalações = 170
Aquisição marca = 100

# Passivo circulante:
Impostos a pagar = 10
Fornecedores = 260

# Passivo não circulante:
Financiamento de Longo Prazo =  200
Capital  = 280
		</textarea><br />
    </div>
	
    <div id="tabs-2">
		<table>
			<tr valign="top">
				<td id="bp_ativo"> </td>
				<td id="bp_passivo"> </td>
			</tr>
		</table>
    </div>
	
	
    <div id="tabs-3">
		<p>
		</p>
    </div>
	
    <div id="tabs-4">
		<p>
			[EM CONSTRUÇÃO]
		</p>
    </div>
	
    <div id="tabs-5">
		<p>
			[EM CONSTRUÇÃO]
		</p>
    </div>
	
    <div id="tabs-6">
		<p>
			[EM CONSTRUÇÃO]
		</p>
    </div>
	
    <div id="tabs-7">
		<p>
			[EM CONSTRUÇÃO]
		</p>
    </div>
	
    <div id="tabs-8">
		<p>
			[EM CONSTRUÇÃO]
		</p>
    </div>
</div>
 
 <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$','$'], ["\\[","\\]"] ],
            processEscapes: true
            },
            TeX: {
            extensions: ["AMSmath.js", "AMSsymbols.js"]
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
        </script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
 
</body>
</html>
